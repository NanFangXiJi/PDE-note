考虑[上一节](./2-格林公式及其应用.md)中提到的求$u$在点$M_0$的式子，已经有$$u(M_0)=-\frac{1}{4\pi}\iint_{\partial \Omega} \big[ u(M)\frac{\partial}{\partial \bm{n}}(\frac{1}{r_{M_0M}})-\frac{1}{r_{M_0M}}\frac{\partial u}{\partial \bm{n}} \big]\text{d}S $$

但是，对于此公式，其同时需要$u$与$\frac{\partial u}{\partial\bm{n}}$在边界的值，这不足以直接用于求解调和方程的Dirichlet与Neumann问题。

本节考虑Dirichlet问题的情景，尝试**消去其中的 $\frac{\partial u}{\partial\bm{n}}$项**。为了达成这一目的，就要引入**格林函数**。

# 格林函数

应当考虑到，之前应用的$v=\frac{1}{r_{M_0M}}$本身的要求就是在边界满足$\frac{1}{r_{M_0M}}$的性质。但问题在于，其仅在$M_0$点不解析，当然也不调和。

那么，为什么不直接找一个在$\Omega$内调和的，并且在边界又满足$\frac{1}{r_{M_0M}}$性质的呢？于是就给出下面的问题来定义一个$g$$$ \begin{equation}
    \nonumber
    \left\{
    \begin{split}
        \Delta g(M,M_0)&=0,\quad M\in \Omega\\
        g(M,M_0)|_{M\in\partial\Omega}&=\frac{1}{4\pi r_{M_0M}}
    \end{split}
    \right.
\end{equation} $$

这样，用$g$来代替$v$，考虑Green第二公式$$\int_\Omega[u\Delta v-v\Delta u ]\text{d}x=\int_{\partial \Omega}[u\frac{\partial v}{\partial \bm{n}}-v\frac{\partial u}{\partial \bm{n}}]\text{d}S $$就能得到$$ \int_{\partial \Omega}[u\frac{\partial v}{\partial \bm{n}}-v\frac{\partial u}{\partial \bm{n}}]\text{d}S=0$$而不用挖去任何地方。

用之前的解加上上式，就有$$u(M_0)=\iint_{\partial \Omega}u\frac{\partial(\frac{1}{4\pi r_{M_0M}}-g)}{\bm{n}}\text{d}S $$

现在考虑令$$G=\frac{1}{4\pi r_{M_0M}}-g $$

这个$G$就是**Green函数**，又可称为Dirichlet问题的源函数。

# Green函数的性质

1. $G|_{M\in \partial \Omega}=0 $
2. - $G$在$M=M_0$外所有点处处调和
   - $M\to M_0$时，$G\to\infty$ 且逼近速度与$\frac{1}{4\pi r_{M_0M}}$相同
3. $0<G<\frac{1}{4\pi r},M\neq M_0$ ，并且 $$\begin{equation}
    \nonumber
    \left\{
    \begin{split}
        \Delta G&=0\\
        G|_{\partial \Omega}&=0\\
        G|_{\partial B_{\epsilon}(M_0)}&>0
    \end{split}
    \right.
\end{equation} $$
1. $G(M_1,M_2)=G(M_2,M_1)$
2. Green函数在边界的积分为-1，即 $$\int_{\partial\Omega}\frac{\partial G}{\partial \bm{n}}\text{d}S=-1 $$

> 下面对性质5进行证明
>
> 证明：
> 首先有$$\int_{\partial\Omega}\frac{\partial G}{\partial \bm{n}}\text{d}S=\int_{\partial\Omega}\big[\frac{\partial(\frac{1}{4\pi r})}{\partial \bm{n}}-\frac{\partial g}{\partial \bm{n}}\big]\text{d}S $$
>
> 考虑散度定理 $$\int_{\partial \Omega}\frac{\partial g}{\partial \bm{n}}\text{d}S= \int_{\partial \Omega}\nabla g\cdot \bm{n}\text{d}S =\int_\Omega \Delta g\text{d}V=0 $$
>
> 再考虑区间$\Omega_\epsilon=\Omega/\overline{B_\epsilon}(M_0) $，然后再一次应用散度定理，有$$\int_{\partial \Omega_\epsilon}\frac{\partial \frac{1}{4\pi r}}{\partial\bm{n}}\text{d}S=\int_{\Omega_\epsilon}\Delta (\frac{1}{4\pi r})\text{d}S=0=\int_{\partial\Omega}\frac{\partial \frac{1}{4\pi r}}{\partial \bm{n}}\text{d}S+\int_{\partial B_\epsilon(M_0)}\frac{\partial \frac{1}{4\pi r}}{\partial \bm{n}}\text{d}S $$
>
> 根据这个就能有$$ \int_{\partial\Omega}\frac{\partial G}{\partial \bm{n}}\text{d}S= -\int_{\partial B_\epsilon(M_0)} \frac{\partial \frac{1}{4\pi r}}{\partial \bm{n}}\text{d}S=-1$$
> 

> Green函数**到底是什么东西**？下面可以在Dirac δ函数意义下来解释。(这一部分应该不是课程考点)。
> 
> ---
> 
> **Dirac δ函数**可理解为一个在某点处是**某种特定的**无穷大，其余点处为零的广义函数。为了更好地解释，这里给出一维区域的例子。
> 
> 在一维区域，可以举例$$h_n(x)=\begin{equation}
    \nonumber
    \left\{
        \begin{split}
            n&,\quad x\in (-\frac{1}{2n},\frac{1}{2n})\\
            0&,\quad \text{otherwise}
        \end{split}
    \right.
\end{equation} $$，那么在某个意义上的极限$\lim_{n\to\infty}h_n(x) $就是关于$x=0$点的Dirac δ函数。
> 这样得到的Dirac δ函数不仅满足一点无穷，其余点为零的要求，还满足全空间积分为$1$。
>
> 上面的只是一种**解释**，现在给出Dirac δ函数的**定义**。这里给出的是积分意义下的定义。
>
> 对于任意给出的$\Omega$上的在$M_0$处连续的函数$\varphi$，满足$$\int_\Omega \delta_{M_0}(M)\varphi(M)\text{d}V=\varphi(M_0) $$，这样的$\delta_{M_0}$就是Dirac δ函数。
>
> 其实还有一种定义，基于微分意义。$$\delta(x)=H'(x) $$，其中$$H(x)=\begin{equation}
    \nonumber
    \left\{
        \begin{split}
            0,\quad x<0\\
            1,\quad x>0
        \end{split}
    \right.
\end{equation} $$
>
> 总体上，Dirac δ函数可以通过卷积操作来筛选出一个函数在某一点的值。
>
> ---
>
> Dirichlet问题的Green函数，本质上就是构造一个函数$G$满足$$\begin{equation}
    \nonumber
    \left\{
        \begin{split}
            \Delta G(M,M_0)=\delta_{M_0}(M),&\quad M\in \Omega\\
            G(M,M_0)=0,&\quad M\in \partial\Omega
        \end{split}
    \right.
\end{equation} $$
>
> 实际上，更广义的Green函数是针对任意一个一般的线性微分算子$\mathcal{L}$，如果想要求解$$\mathcal{L}[u]=f$$，其中$f$是一个源项，那么就要构造Green函数满足$$\mathcal{L}[G(M,M_0)]=\delta_{M_0}(M) $$，那么解就是$$u(x)=\int G(M,M_0) f(M)\text{d}V $$
> 这个积分是在整个源分布区域进行的。我们可以直观地理解这个公式：
> 源项$f(x)$在每一点$x$的强度乘以该点源在$x$处产生的响应$G(x,x)$，然后对所有可能的源点$x$进行叠加（积分），就得到了总的响应$u(x)$。
>
> 因此，从这个角度来理解，Green函数就是**系统对单位点源的响应**。
>
> ---
>
> 另外，从这个角度可以重新证明性质5
> 证明：
> $$ \int_{\partial\Omega}\frac{\partial G}{\partial \bm{n}}\text{d}S=\int_\Omega\Delta G\text{d}V=-\int_\Omega\delta_{M_0}(M)\text{d}V=-1 $$
> 

# 球上的Green函数



